<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dwcPrepare">
<title>dwcPrepare • dwcPrepare</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="dwcPrepare">
<meta property="og:description" content="dwcPrepare">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dwcPrepare</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/dwcPrepare.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jdberson/dwcPrepare/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>dwcPrepare</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jdberson/dwcPrepare/blob/HEAD/vignettes/dwcPrepare.Rmd" class="external-link"><code>vignettes/dwcPrepare.Rmd</code></a></small>
      <div class="d-none name"><code>dwcPrepare.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette shows how to use dwcPrepare to prepare biodiversity
data that use <a href="https://dwc.tdwg.org/" class="external-link">Darwin Core</a> terms.</p>
<p>Currently, a number of Darwin Core <a href="https://dwc.tdwg.org/terms/#event" class="external-link">Event</a> and <a href="https://dwc.tdwg.org/terms/#location" class="external-link">Location</a> terms are
supported by the package, calculated with two wrapper functions
<code><a href="../reference/dwc_Event.html">dwc_Event()</a></code> and <code><a href="../reference/dwc_Location.html">dwc_Location()</a></code>. We think that
the most useful part of the package is to generate some of the Darwin
Core <a href="https://dwc.tdwg.org/terms/#location" class="external-link">Location</a> terms
that require a level of ‘calculation’. For example, the <a href="http://rs.tdwg.org/dwc/terms/coordinateUncertaintyInMeters" class="external-link">coordinateUncertaintyInMeters</a>
and text for the Darwin Core <a href="http://rs.tdwg.org/dwc/terms/locality" class="external-link">locality</a> term.</p>
<p>Most functions in the package can take data from a single location /
event directly as part of their arguments. However, we will mostly have
a spreadsheet with multiple locations / events that we wish to format to
<a href="https://dwc.tdwg.org/" class="external-link">Darwin Core</a> terms. The following
examples show how to use dwcPrepare with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> in
the case where we have multiple locations / events. Please see the
individual help files for examples with a single location / event.</p>
</div>
<div class="section level2">
<h2 id="darwin-core-location-terms">Darwin Core Location terms<a class="anchor" aria-label="anchor" href="#darwin-core-location-terms"></a>
</h2>
<p>First let’s walk through generating the Darwin Core Location
terms.</p>
<p>Note, if you have a small number of locations, you may wish to use
the the online <a href="http://georeferencing.org/georefcalculator/gc.html" class="external-link">Georeferencing
Calculator</a> (Wieczorek and Wieczorek 2021). This has more options
than we provide here, including calculating the uncertainty from an
unknown datum. We relied heavily on this calculator and associated
documentation when writing this package. Output from the calculator can
be formatted for use in R using the <code><a href="../reference/dwc_format_gco.html">dwc_format_gco()</a></code>
function.</p>
<div class="section level3">
<h3 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jdberson/dwcPrepare" class="external-link">dwcPrepare</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-raw-data">Prepare raw data<a class="anchor" aria-label="anchor" href="#prepare-raw-data"></a>
</h3>
<p>dwcPrepare comes with a small mock data set - Let’s load the data and
take a quick look.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"thylacine_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thylacine_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 13</span></span></span>
<span><span class="co">#&gt;   site   trap     date_trap_setup   date_trap_collected longitude_dd latitude_dd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Sumac  Sumac 1  05/09/2022 10:32… 06/09/2022 12:24:00         145.       -<span style="color: #BB0000;">41.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Sumac  Sumac 2  05/09/2022 12:15… 06/09/2022 14:57:00         145.       -<span style="color: #BB0000;">41.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Sumac  Sumac 1  05/10/2022 08:23… 06/10/2022 0:00:00          145.       -<span style="color: #BB0000;">41.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Sumac  Sumac 2  05/10/2022 10:14… 06/10/2022 10:29:00         145.       -<span style="color: #BB0000;">41.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Picton Picton 1 10/09/2022 10:32… 11/09/2022 12:24:00         147.       -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Picton Picton 2 10/09/2022 12:15… 11/09/2022 14:57:00         147.       -<span style="color: #BB0000;">43.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Picton Picton 1 10/10/2022 0:00:… 11/10/2022 08:46:00         147.       -<span style="color: #BB0000;">43.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> Picton Picton 2 10/10/2022 10:14… 11/10/2022 10:29:00         147.       -<span style="color: #BB0000;">43.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: longitude_dms &lt;chr&gt;, latitude_dms &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   longitude_ddm &lt;chr&gt;, latitude_ddm &lt;chr&gt;, gps_uncertainty &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   species &lt;chr&gt;, count &lt;dbl&gt;</span></span></span>
<span><span class="co"># see ?thylacine_data for more information</span></span></code></pre></div>
<p>You will see that the data include latitude and longitude in three
formats: decimal degrees (<code>_dd</code>), degrees minutes seconds
(<code>_dms</code>) and degrees decimal minutes (<code>_ddm</code>).
These are the three formats supported by dwcPrepare, which uses the <a href="https://docs.ropensci.org/parzer/" class="external-link">parzer</a> R package to convert
coordinates to decimal degrees if needed. We have included all three
formats so that users can choose which format to use when trying out the
functions. Here we choose degrees minutes seconds for this vignette, so
we’ll remove unnecessary columns:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">longitude_dd</span><span class="op">:</span><span class="va">latitude_dms</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="location-terms-step-by-step">Location terms step-by-step<a class="anchor" aria-label="anchor" href="#location-terms-step-by-step"></a>
</h3>
<p>We can now go through building up the location terms step by
step.</p>
<p>First, we use <code><a href="../reference/dwc_coordinates.html">dwc_coordinates()</a></code> to do some checks, get
our longitude and latitude in the right format, and record some basic
information:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data_a</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/dwc_coordinates.html">dwc_coordinates</a></span><span class="op">(</span></span>
<span>      longitude <span class="op">=</span> <span class="va">longitude_ddm</span>,</span>
<span>      latitude <span class="op">=</span> <span class="va">latitude_ddm</span>,</span>
<span>      verbatimCoordinateSystem <span class="op">=</span> <span class="st">"degrees decimal minutes"</span>,</span>
<span>      verbatimSRS <span class="op">=</span> <span class="st">"EPSG:4326"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Two things to note from the above. One is that
<code><a href="../reference/dwc_coordinates.html">dwc_coordinates()</a></code> is called inside of
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>. If, like above, a
<code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> is returned by the <code>dwcPrepare</code>
function, then there is no need to specify a column name within
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>. However, if a single vector is returned,
then a column name needs to be specified (see the next code chunk).</p>
<p>The other thing to note is that by giving strings to the
<code>verbatimCoordinateSystem</code> and <code>verbatimSRS</code>, we
are telling <code><a href="../reference/dwc_coordinates.html">dwc_coordinates()</a></code> that these values apply to
all rows in the dataframe.</p>
<p>Next we calculate the precision of our coordinates:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data_b</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data_a</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    coordinatePrecision <span class="op">=</span> <span class="fu"><a href="../reference/dwc_coordinatePrecision.html">dwc_coordinatePrecision</a></span><span class="op">(</span></span>
<span>      verbatimLatitude <span class="op">=</span> <span class="va">verbatimLatitude</span>,</span>
<span>      verbatimLongitude <span class="op">=</span> <span class="va">verbatimLongitude</span>,</span>
<span>      verbatimCoordinateSystem <span class="op">=</span> <span class="va">verbatimCoordinateSystem</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We now have all the information we need to calculate the coordinate
uncertainty in meters:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data_c</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data_b</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    coordinateUncertaintyInMeters <span class="op">=</span> <span class="fu"><a href="../reference/dwc_coordinateUncertaintyInMeters.html">dwc_coordinateUncertaintyInMeters</a></span><span class="op">(</span></span>
<span>      decimalLatitude <span class="op">=</span> <span class="va">decimalLatitude</span>,</span>
<span>      coordinatePrecision <span class="op">=</span> <span class="va">coordinatePrecision</span>,</span>
<span>      geodeticDatum <span class="op">=</span> <span class="va">geodeticDatum</span>,</span>
<span>      gps_uncertainty <span class="op">=</span> <span class="va">gps_uncertainty</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Next, if we have a shape file with the country, countryCode,
stateProvince and county information for our area of interest, we can
use <code><a href="../reference/dwc_country_to_county.html">dwc_country_to_county()</a></code> to assign these values for each
of our points.</p>
<p>dwcPrepare includes shape file for the area where our mock data were
collected.</p>
<p><strong>Warning:</strong> The <code><a href="../reference/dwc_country_to_county.html">dwc_country_to_county()</a></code>
function differs to the other <code>dwcPrepare</code> functions in two
ways. First, it is not wrapped in <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> when
applying to a dataframe. Also, column names are given as strings. We may
update this in a future version of the package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the sf object with the county shape files that include the country,</span></span>
<span><span class="co"># countryCode, stateProvince and county information for the area of interest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"county_tas"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thylacine_data_d</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/dwc_country_to_county.html">dwc_country_to_county</a></span><span class="op">(</span></span>
<span>    <span class="va">thylacine_data_c</span>,</span>
<span>    decimalLongitude <span class="op">=</span> <span class="st">"decimalLongitude"</span>,</span>
<span>    decimalLatitude <span class="op">=</span> <span class="st">"decimalLatitude"</span>,</span>
<span>    county_sf <span class="op">=</span> <span class="va">county_tas</span>,</span>
<span>    country_column_name <span class="op">=</span> <span class="st">"country"</span>,</span>
<span>    countryCode_column_name <span class="op">=</span> <span class="st">"countryCode"</span>,</span>
<span>    stateProvince_column_name <span class="op">=</span> <span class="st">"stateProvince"</span>,</span>
<span>    county_column_name <span class="op">=</span> <span class="st">"county"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Finally, a useful feature of dwcPrepare is providing information that
can be used in the Darwin Core <a href="http://rs.tdwg.org/dwc/terms/locality" class="external-link">locality</a> field using
<code><a href="../reference/dwc_locality.html">dwc_locality()</a></code>.</p>
<p>This function does require an <a href="https://r-spatial.github.io/sf/index.html" class="external-link">sf</a> POINT object
that includes the locality names and their longitude and latitude for
the area of interest. dwcPrepare comes with this object for Australian
localities (<code><a href="../reference/locality_data_aus.html">locality_data_aus()</a></code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load localities data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"locality_data_aus"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thylacine_data_e</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data_d</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    locality <span class="op">=</span> <span class="fu"><a href="../reference/dwc_locality.html">dwc_locality</a></span><span class="op">(</span></span>
<span>      decimalLongitude <span class="op">=</span> <span class="va">decimalLongitude</span>,</span>
<span>      decimalLatitude <span class="op">=</span> <span class="va">decimalLatitude</span>,</span>
<span>      localities_sf <span class="op">=</span> <span class="va">locality_data_aus</span>,</span>
<span>      localities_names <span class="op">=</span> <span class="st">"locality_name"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span><span class="co">#&gt; which was just loaded, will retire in October 2023.</span></span>
<span><span class="co">#&gt; Please refer to R-spatial evolution reports for details, especially</span></span>
<span><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span><span class="co">#&gt; It may be desirable to make the sf package available;</span></span>
<span><span class="co">#&gt; package maintainers should consider adding sf to Suggests:.</span></span>
<span><span class="co">#&gt; The sp package is now running under evolution status 2</span></span>
<span><span class="co">#&gt;      (status 2 uses the sf package in place of rgdal)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="location-terms-with-one-function">Location terms with one function<a class="anchor" aria-label="anchor" href="#location-terms-with-one-function"></a>
</h3>
<p>Our final dataframe above, thylacine_data_e, includes the Darwin Core
Location fields: <a href="http://rs.tdwg.org/dwc/terms/decimalLatitude" class="external-link">decimalLatitude</a>,
<a href="http://rs.tdwg.org/dwc/terms/decimalLongitude" class="external-link">decimalLongitude</a>,
<a href="http://rs.tdwg.org/dwc/terms/geodeticDatum" class="external-link">geodeticDatum</a>,
<a href="http://rs.tdwg.org/dwc/terms/coordinateUncertaintyInMeters" class="external-link">coordinateUncertaintyInMeters</a>,
<a href="http://rs.tdwg.org/dwc/terms/coordinatePrecision" class="external-link">coordinatePrecision</a>,
<a href="http://rs.tdwg.org/dwc/terms/verbatimLatitude" class="external-link">verbatimLatitude</a>,
<a href="http://rs.tdwg.org/dwc/terms/verbatimLongitude" class="external-link">verbatimLongitude</a>,
<a href="http://rs.tdwg.org/dwc/terms/verbatimCoordinateSystem" class="external-link">verbatimCoordinateSystem</a>,
<a href="http://rs.tdwg.org/dwc/terms/verbatimSRS" class="external-link">verbatimSRS</a>, <a href="http://rs.tdwg.org/dwc/terms/country" class="external-link">country</a>, <a href="http://rs.tdwg.org/dwc/terms/countryCode" class="external-link">countryCode</a>, <a href="http://rs.tdwg.org/dwc/terms/stateProvince" class="external-link">stateProvince</a>, <a href="http://rs.tdwg.org/dwc/terms/county" class="external-link">county</a> and <a href="http://rs.tdwg.org/dwc/terms/locality" class="external-link">locality</a>.</p>
<p>Rather than generating these terms step-by-step, we can use the
wrapper function <code><a href="../reference/dwc_Location.html">dwc_Location()</a></code> to do everything in one
step:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data_location</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/dwc_Location.html">dwc_Location</a></span><span class="op">(</span></span>
<span>      longitude <span class="op">=</span> <span class="va">longitude_ddm</span>,</span>
<span>      latitude <span class="op">=</span> <span class="va">latitude_ddm</span>,</span>
<span>      verbatimCoordinateSystem <span class="op">=</span> <span class="st">"degrees decimal minutes"</span>,</span>
<span>      verbatimSRS <span class="op">=</span> <span class="st">"EPSG:4326"</span>,</span>
<span>      gps_uncertainty <span class="op">=</span> <span class="va">gps_uncertainty</span>,</span>
<span>      localities_sf <span class="op">=</span> <span class="va">locality_data_aus</span>,</span>
<span>      localities_names <span class="op">=</span> <span class="st">"locality_name"</span>,</span>
<span>      county_sf <span class="op">=</span> <span class="va">county_tas</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Much easier!</p>
</div>
</div>
<div class="section level2">
<h2 id="darwin-core-event-terms">Darwin Core Event terms<a class="anchor" aria-label="anchor" href="#darwin-core-event-terms"></a>
</h2>
<p>There is only a single function for Darwin Core <a href="https://dwc.tdwg.org/terms/#event" class="external-link">Event</a> terms:
<code><a href="../reference/dwc_Event.html">dwc_Event()</a></code>. This is because the <a href="https://lubridate.tidyverse.org/" class="external-link">lubridate</a> R package already
includes many functions that can be used to calculate Darwin Core <a href="https://dwc.tdwg.org/terms/#event" class="external-link">Event</a> terms.
<code><a href="../reference/dwc_Event.html">dwc_Event()</a></code> provides a wrapper for a series of <a href="https://lubridate.tidyverse.org/" class="external-link">lubridate</a> functions, and
experienced R users may prefer to use the <a href="https://lubridate.tidyverse.org/" class="external-link">lubridate</a> functions directly
(we have found <code><a href="../reference/dwc_Event.html">dwc_Event()</a></code> to be slow for large
datasets).</p>
<p>The Darwin Core terms returned by <code><a href="../reference/dwc_Event.html">dwc_Event()</a></code> are: <a href="http://rs.tdwg.org/dwc/terms/eventDate" class="external-link">eventDate</a>, <a href="http://rs.tdwg.org/dwc/terms/startDayOfYear" class="external-link">startDayOfYear</a>,
<a href="http://rs.tdwg.org/dwc/terms/endDayOfYear" class="external-link">endDayOfYear</a>, <a href="http://rs.tdwg.org/dwc/terms/year" class="external-link">year</a>, <a href="http://rs.tdwg.org/dwc/terms/month" class="external-link">month</a>, <a href="http://rs.tdwg.org/dwc/terms/day" class="external-link">day</a>, <a href="http://rs.tdwg.org/dwc/terms/verbatimEventDate" class="external-link">verbatimEventDate</a>,
and optionally <a href="http://rs.tdwg.org/dwc/terms/fieldNumber" class="external-link">fieldNumber</a>, <a href="http://rs.tdwg.org/dwc/terms/habitat" class="external-link">habitat</a>, <a href="http://rs.tdwg.org/dwc/terms/samplingProtocol" class="external-link">samplingProtocol</a>,
<a href="http://rs.tdwg.org/dwc/terms/samplingEffort" class="external-link">samplingEffort</a>,
<a href="http://rs.tdwg.org/dwc/terms/fieldNotes" class="external-link">fieldNotes</a> and <a href="http://rs.tdwg.org/dwc/terms/eventRemarks" class="external-link">eventRemarks</a>. If
both start and end date/date-time are supplied the function will also
return: <a href="http://rs.tdwg.org/dwc/terms/sampleSizeValue" class="external-link">sampleSizeValue</a>,
<a href="http://rs.tdwg.org/dwc/terms/sampleSizeUnit" class="external-link">sampleSizeUnit</a>.</p>
<p>For example, using our <code><a href="../reference/thylacine_data.html">thylacine_data()</a></code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thylacine_data_event</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">thylacine_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/dwc_Event.html">dwc_Event</a></span><span class="op">(</span></span>
<span>      start <span class="op">=</span> <span class="va">date_trap_setup</span>,</span>
<span>      end <span class="op">=</span> <span class="va">date_trap_collected</span>,</span>
<span>      tzone <span class="op">=</span> <span class="st">"Australia/Hobart"</span>,</span>
<span>      samplingEffort <span class="op">=</span> <span class="st">"1 trap"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Wieczorek C, J Wieczorek (2021) Georeferencing Calculator. Available:
<a href="http://georeferencing.org/georefcalculator/gc.html" class="external-link uri">http://georeferencing.org/georefcalculator/gc.html</a>.
Accessed [2023-03-09].</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jacob Berson, Jake Manger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
